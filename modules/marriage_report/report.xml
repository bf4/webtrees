<?xml version="1.0" encoding="UTF-8"?>
<Report>
	<!-- $Id$ -->
	<Title><var var="i18n::translate('Marriage Date and Place Report')" /></Title>
	<Description>Prints a list of families matching specific name and/or marriage criteria</Description>
	<Input name="name" lookup="NAME" type="text"><var var="i18n::translate('Name')" /></Input>
	<Input name="marrplace" lookup="PLAC" type="text"><var var="i18n::translate('Marriage Place contains')" /> </Input>
	<Input name="marrdate1" lookup="DATE" type="text"><var var="i18n::translate('Marriage Date range start')" /></Input>
	<Input name="marrdate2" lookup="DATE" type="text"><var var="i18n::translate('Marriage Date range end')" /></Input>
	<Input name="sortby" type="select" options="NAME=>i18n::translate('Name')|MARR:DATE=>i18n::translate('Date of Marriage')"><var var="i18n::translate('Sort by')" /></Input>
	<Input name="pageSize" type="select" default="A4" options="letter=>i18n::translate_c('paper size','Letter')|A3=>i18n::translate_c('paper size', 'A3')|A4=>i18n::translate_c('paper size','A4')|legal=>i18n::translate_c('paper size','Legal')"><var var="i18n::translate('Page size')" /></Input>
	<Input name="fonts" type="select" default="dejavusans" options="arialunicid0=>i18n::translate_c('font name', 'Arial')|dejavusans=>i18n::translate_c('font name', 'DejaVu')|helvetica=>i18n::translate_c('font name', 'Helvetica')"><var var="i18n::translate('Font')"/></Input>

	<!-- Header -->
	<Style name="header" font="$fonts" size="16" style="b" />
	<!-- Page numbers text -->
	<Style name="pagenum" font="$fonts" size="8"/>
	<!-- Generated by style - required style name by the generator -->
	<Style name="genby" font="$fonts" size="8" />
	<!-- Date tetx -->
	<Style name="date" font="$fonts" size="8"/>
	<Style name="text" font="$fonts" size="9" />
	<Style name="spouse" font="$fonts" size="8" />
	<Style name="label" font="$fonts" size="10" style="b"/>

	<Doc pageSize="$pageSize" orientation="landscape">
		<Header>
			<Cell align="center" height="20" newline="1" style="header"><var var="i18n::translate('Marriage Date and Place Report')" /></Cell>
			<Cell align="rightrtl" height="10" newline="1" style="pagenum"><var var="i18n::translate('Page')" /> <PageNum /> <var var="i18n::translate('of')" /> <TotalPages /></Cell>

			<SetVar name="fill" value="" />
			<if condition="$sortby=='NAME'">
				<SetVar name="fill" value="#AAAAAA" />
			</if>
			<TextBox bgcolor="$fill" border="1" height="12" width="200">
				<Text style="label"><var var="i18n::translate('Name')" /></Text>
			</TextBox>

			<SetVar name="fill" value="" />
			<if condition="$sortby=='MARR:DATE'">
				<SetVar name="fill" value="#AAAAAA" />
			</if>
			<TextBox bgcolor="$fill" border="1" height="12" width="100">
				<Text style="label"><var var="i18n::translate('Date')" /></Text>
			</TextBox>

			<TextBox border="1" height="12" width="225">
				<Text style="label"><var var="i18n::translate('Place')" /></Text>
			</TextBox>

			<TextBox border="1" height="12" newline="1">
				<Text style="label"><var var="i18n::translate('Source')" /></Text>
			</TextBox>
		</Header>

		<Body>
			<SetVar name="printedFamilies" value="0" />
			<List list="family" filter1="MARR:PLAC CONTAINS $marrplace" filter2="MARR:DATE GTE $marrdate1" filter3="MARR:DATE LTE $marrdate2" sortby="$sortby">
			<!-- filter4 should be: filter4="NAME CONTAINS $name", but the family name doesn't exist as a field in the database,
					so we can't use that.  -->
				<SetVar name="skipFamily" value="no" />
				<if condition="$name!=''">
					<SetVar name="skipFamily" value="yes" />
					<Gedcom id="@HUSB">
						<if condition="stristr(@NAME,$name)!==false">
							<SetVar name="skipFamily" value="no" />
						</if>
					</Gedcom>
					<Gedcom id="@WIFE">
						<if condition="stristr(@NAME,$name)!==false">
							<SetVar name="skipFamily" value="no" />
						</if>
					</Gedcom>
				</if>
				<if condition="$skipFamily=='no'">
					<SetVar name="printedFamilies" value="$printedFamilies+1" />

					<TextBox height="12" width="200">
						<Text style="text"><GetPersonName id="@HUSB" /></Text>
						<Text style="spouse">
							<br />   <GetPersonName id="@WIFE" />  (<GedcomValue tag="@id" />)
						</Text>
					</TextBox>

					<TextBox height="12" width="100">
						<Text style="text"><GedcomValue tag="MARR:DATE" newline="1" /></Text>
					</TextBox>

					<TextBox height="12" width="225">
						<Text style="text"><GedcomValue tag="MARR:PLAC" /></Text>
					</TextBox>

					<TextBox height="12" newline="1">
						<!-- Only with multiple sources use line feed (br) -->
						<SetVar name="usebr" value="0"/>
						<Text style="text">
							<RepeatTag tag="MARR:SOUR">
								<Gedcom id="@SOUR">
									<if condition="$usebr==1"><br /></if>
									<GedcomValue tag="TITL" />
								</Gedcom>
								<SetVar name="usebr" value="1"/>
							</RepeatTag>
						</Text>
					</TextBox>

				</if>
			</List>
			<Cell align="rightrtl" height="24" newline="1" style="label"><br/><var var="i18n::translate('Total families')"/>: <var var="printedFamilies" /></Cell>
		</Body>
		<Footer>
			<Cell align="rightrtl" newline="1" style="date"><Now/></Cell>
		</Footer>
	</Doc>
</Report>
