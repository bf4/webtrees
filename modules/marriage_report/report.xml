<?xml version="1.0" encoding="UTF-8"?>
<PGVReport>
	<!-- $Id$ -->
	<PGVRTitle><PGVRvar var="i18n::translate('Marriage Date and Place Report')" /></PGVRTitle>
	<PGVRDescription>Prints a list of families matching specific name and/or marriage criteria</PGVRDescription>
	<PGVRInput name="name" lookup="NAME" type="text"><PGVRvar var="i18n::translate('Name')" /></PGVRInput>
	<PGVRInput name="marrplace" lookup="PLAC" type="text"><PGVRvar var="i18n::translate('Marriage Place contains')" /> </PGVRInput>
	<PGVRInput name="marrdate1" lookup="DATE" type="text"><PGVRvar var="i18n::translate('Marriage Date range start')" /></PGVRInput>
	<PGVRInput name="marrdate2" lookup="DATE" type="text"><PGVRvar var="i18n::translate('Marriage Date range end')" /></PGVRInput>
	<PGVRInput name="sortby" type="select" options="NAME=>i18n::translate('Name')|MARR:DATE=>i18n::translate('Date of Marriage')"><PGVRvar var="i18n::translate('Sort by')" /></PGVRInput>
	<PGVRInput name="pageSize" type="select" default="A4" options="letter=>i18n::translate_c('paper size','Letter')|A3=>i18n::translate_c('paper size', 'A3')|A4=>i18n::translate_c('paper size','A4')|legal=>i18n::translate_c('paper size','Legal')"><PGVRvar var="i18n::translate('Page size')" /></PGVRInput>
	<PGVRInput name="fonts" type="select" default="dejavusans" options="arialunicid0=>i18n::translate_c('font name', 'Arial')|dejavusans=>i18n::translate_c('font name', 'DejaVu')|helvetica=>i18n::translate_c('font name', 'Helvetica')"><PGVRvar var="i18n::translate('Font')"/></PGVRInput>

	<!-- Header -->
	<PGVRStyle name="header" font="$fonts" size="16" style="b" />
	<!-- Page numbers text -->
	<PGVRStyle name="pagenum" font="$fonts" size="8"/>
	<!-- Generated by style - required style name by the generator -->
	<PGVRStyle name="genby" font="$fonts" size="8" />
	<!-- Date tetx -->
	<PGVRStyle name="date" font="$fonts" size="8"/>
	<PGVRStyle name="text" font="$fonts" size="9" />
	<PGVRStyle name="spouse" font="$fonts" size="8" />
	<PGVRStyle name="label" font="$fonts" size="10" style="b"/>

	<PGVRDoc pageSize="$pageSize" orientation="landscape">
		<PGVRHeader>
			<PGVRCell align="center" height="20" newline="1" style="header"><PGVRvar var="i18n::translate('Marriage Date and Place Report')" /></PGVRCell>
			<PGVRCell align="rightrtl" height="10" newline="1" style="pagenum"><PGVRvar var="i18n::translate('Page')" /> <PGVRPageNum /> <PGVRvar var="i18n::translate('of')" /> <PGVRTotalPages /></PGVRCell>

			<PGVRSetVar name="fill" value="" />
			<PGVRif condition="$sortby=='NAME'">
				<PGVRSetVar name="fill" value="#AAAAAA" />
			</PGVRif>
			<PGVRTextBox bgcolor="$fill" border="1" height="12" width="200">
				<PGVRText style="label"><PGVRvar var="i18n::translate('Name')" /></PGVRText>
			</PGVRTextBox>

			<PGVRSetVar name="fill" value="" />
			<PGVRif condition="$sortby=='MARR:DATE'">
				<PGVRSetVar name="fill" value="#AAAAAA" />
			</PGVRif>
			<PGVRTextBox bgcolor="$fill" border="1" height="12" width="100">
				<PGVRText style="label"><PGVRvar var="i18n::translate('Date')" /></PGVRText>
			</PGVRTextBox>

			<PGVRTextBox border="1" height="12" width="225">
				<PGVRText style="label"><PGVRvar var="i18n::translate('Place')" /></PGVRText>
			</PGVRTextBox>

			<PGVRTextBox border="1" height="12" newline="1">
				<PGVRText style="label"><PGVRvar var="i18n::translate('Source')" /></PGVRText>
			</PGVRTextBox>
		</PGVRHeader>

		<PGVRBody>
			<PGVRSetVar name="printedFamilies" value="0" />
			<PGVRList list="family" filter1="MARR:PLAC CONTAINS $marrplace" filter2="MARR:DATE GTE $marrdate1" filter3="MARR:DATE LTE $marrdate2" sortby="$sortby">
			<!-- filter4 should be: filter4="NAME CONTAINS $name", but the family name doesn't exist as a field in the database,
					so we can't use that.  -->
				<PGVRSetVar name="skipFamily" value="no" />
				<PGVRif condition="$name!=''">
					<PGVRSetVar name="skipFamily" value="yes" />
					<PGVRGedcom id="@HUSB">
						<PGVRif condition="stristr(@NAME,$name)!==false">
							<PGVRSetVar name="skipFamily" value="no" />
						</PGVRif>
					</PGVRGedcom>
					<PGVRGedcom id="@WIFE">
						<PGVRif condition="stristr(@NAME,$name)!==false">
							<PGVRSetVar name="skipFamily" value="no" />
						</PGVRif>
					</PGVRGedcom>
				</PGVRif>
				<PGVRif condition="$skipFamily=='no'">
					<PGVRSetVar name="printedFamilies" value="$printedFamilies+1" />

					<PGVRTextBox height="12" width="200">
						<PGVRText style="text"><PGVRGetPersonName id="@HUSB" /></PGVRText>
						<PGVRText style="spouse">
							<br />   <PGVRGetPersonName id="@WIFE" />  (<PGVRGedcomValue tag="@id" />)
						</PGVRText>
					</PGVRTextBox>

					<PGVRTextBox height="12" width="100">
						<PGVRText style="text"><PGVRGedcomValue tag="MARR:DATE" newline="1" /></PGVRText>
					</PGVRTextBox>

					<PGVRTextBox height="12" width="225">
						<PGVRText style="text"><PGVRGedcomValue tag="MARR:PLAC" /></PGVRText>
					</PGVRTextBox>

					<PGVRTextBox height="12" newline="1">
						<!-- Only with multiple sources use line feed (br) -->
						<PGVRSetVar name="usebr" value="0"/>
						<PGVRText style="text">
							<PGVRRepeatTag tag="MARR:SOUR">
								<PGVRGedcom id="@SOUR">
									<PGVRif condition="$usebr==1"><br /></PGVRif>
									<PGVRGedcomValue tag="TITL" />
								</PGVRGedcom>
								<PGVRSetVar name="usebr" value="1"/>
							</PGVRRepeatTag>
						</PGVRText>
					</PGVRTextBox>

				</PGVRif>
			</PGVRList>
			<PGVRCell align="rightrtl" height="24" newline="1" style="label"><br/><PGVRvar var="i18n::translate('Total families')"/>: <PGVRvar var="printedFamilies" /></PGVRCell>
		</PGVRBody>
		<PGVRFooter>
			<PGVRCell align="rightrtl" newline="1" style="date"><PGVRNow/></PGVRCell>
		</PGVRFooter>
	</PGVRDoc>
</PGVReport>
